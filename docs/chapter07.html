<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Numerical integration – Numerical Analysis 2018-23</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter08.html" rel="next">
<link href="./chapter06.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-eee2ee4d5e4f76f365a16d0cec9c0489.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
MathJax = {
  loader: {
    load: ['[tex]/boldsymbol']
  },
  tex: {
    tags: "all",
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    packages: {
      '[+]': ['boldsymbol']
    }
  }
};
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="7&nbsp; Numerical integration – Numerical Analysis 2018-23">
<meta property="og:description" content="">
<meta property="og:image" content="figures/chapter07/trapezium.png">
<meta property="og:site_name" content="Numerical Analysis 2018-23">
<meta name="twitter:title" content="7&nbsp; Numerical integration – Numerical Analysis 2018-23">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="figures/chapter07/trapezium.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter07.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Numerical integration</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Numerical Analysis 2018-23</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://maths.york.ac.uk/moodle/course/view.php?id=2528" title="Moodle page" class="quarto-navigation-tool px-1" aria-label="Moodle page"><i class="bi bi-mortarboard-fill"></i></a>
    <a href="https://github.com/gustavdelius/NumericalAnalysis2018-23/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Numerical-Analysis-2018-23.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Errors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Solving nonlinear equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Solving systems of nonlinear equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Iterative techniques for solving systems of linear equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximation and interpolation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter07.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Numerical integration</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Numerical differentiation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">A direct method for solving tridiagonal linear systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ivp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Initial Value Problems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bvp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Boundary Value Problems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pde.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Partial Differential Equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Taylor’s theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#trapezium-rule" id="toc-trapezium-rule" class="nav-link active" data-scroll-target="#trapezium-rule"><span class="header-section-number">7.1</span> Trapezium rule</a></li>
  <li><a href="#simpsons-rule" id="toc-simpsons-rule" class="nav-link" data-scroll-target="#simpsons-rule"><span class="header-section-number">7.2</span> Simpson’s rule</a></li>
  <li><a href="#higher-order-newton-cotes-formulae" id="toc-higher-order-newton-cotes-formulae" class="nav-link" data-scroll-target="#higher-order-newton-cotes-formulae"><span class="header-section-number">7.3</span> Higher-order Newton-Cotes formulae</a></li>
  <li><a href="#composite-numerical-integration" id="toc-composite-numerical-integration" class="nav-link" data-scroll-target="#composite-numerical-integration"><span class="header-section-number">7.4</span> Composite numerical integration</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/gustavdelius/NumericalAnalysis2018-23/edit/main/chapter07.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-integration" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Numerical integration</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>We now discuss approximation algorithms for evaluating definite integrals. For many functions of practical relevance, their antiderivative is not explicitly known, so that integrating them is not possible in explicit terms. For example, an integral like <span id="eq-int:exp"><span class="math display">\[
\int_0^2 \exp(-x^2)dx
\tag{7.1}\]</span></span> can be evaluated only by numerical approximation.</p>
<p>The basic method for approximating an integral of a function <span class="math inline">\(f(x)\)</span> is called <em>numerical quadrature</em> and uses a formula of the form <span id="eq-int:quad"><span class="math display">\[
\int_a^bf(x)dx\approx \sum_{i=0}^nc_if(x_i),
\tag{7.2}\]</span></span> where <span class="math inline">\(x_0,\ldots,x_n\)</span> are <em>nodes</em> and <span class="math inline">\(c_0,\ldots,c_n\)</span> are <em>weights</em>. The nodes are chosen in the interval <span class="math inline">\([a,b]\)</span> and the weights are chosen so that the formula is exact for polynomials of degree <span class="math inline">\(n\)</span>. The integral of a general function <span class="math inline">\(f\)</span> is then approximated by the integral of the interpolating polynomial <span class="math inline">\(P_n\)</span> of degree <span class="math inline">\(n\)</span> through the nodes <span class="math inline">\(x_0,\ldots,x_n\)</span> of <span class="math inline">\(f\)</span>. In other words, the integral is replaced with a discrete sum of function values of <span class="math inline">\(f\)</span> with certain numerical coefficients.</p>
<p>For a simple example, consider <span class="math inline">\(\int_a^bf(x)dx\)</span> for a nonnegative function <span class="math inline">\(f\)</span>; illustrated in <a href="#fig-trapezium" class="quarto-xref">Figure&nbsp;<span>7.1</span></a>. The integral <span class="math inline">\(\int_a^bf(x)dx\)</span> corresponds to the area under the graph of&nbsp;<span class="math inline">\(f\)</span> in the interval <span class="math inline">\([a,b]\)</span>. This region can be approximated by a trapezium through the points <span class="math inline">\((a,0)\)</span>, <span class="math inline">\((a,f(a))\)</span>, <span class="math inline">\((b,f(b))\)</span>, <span class="math inline">\((b,0)\)</span>. Computing the area of the trapezium, we obtain <span id="eq-int:trapezium"><span class="math display">\[
\int_a^bf(x)dx\approx (b-a)\frac{(f(a)+f(b))}{2}.
\tag{7.3}\]</span></span> This is the so-called <em>Trapezium rule</em>.</p>
<div id="fig-trapezium" class="quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trapezium-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/chapter07/trapezium.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trapezium-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Trapezium rule
</figcaption>
</figure>
</div>
<p>We motivated the Trapezium rule geometrically, but two question remain open at this point:</p>
<ol type="a">
<li><p>How large is the approximation error?</p></li>
<li><p>How can the approximation be improved for additional precision?</p></li>
</ol>
<p>We will answer these questions by generalizing the Trapezium rule as follows. First, we select a collection of distinct points <span class="math inline">\(x_0, x_1, \ldots, x_n\)</span> from the interval <span class="math inline">\([a,b]\)</span>. Then, in generalization of the straight line that interpolated the function <span class="math inline">\(f\)</span> in the Trapezium method, we construct the Lagrange interpolating polynomial (see <a href="chapter06.html#thm-Lagrange-error" class="quarto-xref">Theorem&nbsp;<span>6.3</span></a>) through <span class="math inline">\(x_0,\ldots,x_n\)</span> to obtain <span id="eq-int:lagrange"><span class="math display">\[
f(x)=\sum_{i=0}^nf(x_i)L_i(x) + R(x),
\tag{7.4}\]</span></span> where <span id="eq-int:remainder"><span class="math display">\[
R(x) = \frac{f^{(n+1)}(\xi(x))}{(n+1)!}\prod_{i=0}^n
(x-x_i)
\tag{7.5}\]</span></span> and <span class="math inline">\(\xi(x)\in[a,b]\)</span> for each <span class="math inline">\(x\)</span>. Integrating this formula over <span class="math inline">\([a, b]\)</span>, we obtain <span id="eq-int:def"><span class="math display">\[
\int_a^bf(x)dx=\sum_{i=0}^nc_if(x_i) + E(f)
\tag{7.6}\]</span></span> where <span id="eq-int:coeff"><span class="math display">\[
\begin{aligned}
c_i&amp;= \int_a^b L_i(x)dx, &amp;
E(f)&amp;=\int_a^b R(x)\,dx.
\end{aligned}
\tag{7.7}\]</span></span> The idea is that it is desirable for the error term <span class="math inline">\(E(f)\)</span> to be small—more on that below.</p>
<p>It is usual to choose the nodes <span class="math inline">\(x_0,\ldots,x_n\)</span> equally spaced in the interval <span class="math inline">\([a,b]\)</span>, in other words, with <span class="math inline">\(h=\frac{1}{n}(b-a)\)</span>, one sets <span id="eq-int:nodes"><span class="math display">\[
x_i := a + i h \quad\text{for }i=0,\ldots,n.
\tag{7.8}\]</span></span> The construction above then yields the so called <strong>closed Newton-Cotes formulae</strong> for integration. Let us consider the cases of <span class="math inline">\(n=1\)</span> (which corresponds to the Trapezium rule as above) and <span class="math inline">\(n=2\)</span> in more detail.</p>
<section id="trapezium-rule" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="trapezium-rule"><span class="header-section-number">7.1</span> Trapezium rule</h2>
<p>Let us now put <span class="math inline">\(n=1\)</span>, that is, we use interpolation by a straight line. Following the recipe from above, we have <span class="math inline">\(h:=b-a\)</span>, the nodes are <span class="math inline">\(x_0=a\)</span> and <span class="math inline">\(x_1=b\)</span>, and we have the Lagrange polynomials <span id="eq-int:lagrange-1"><span class="math display">\[
\begin{split}
   L_0(x) &amp;= \frac{x-x_1}{x_0-x_1} = -\frac{1}{h}(x-b), \\
   L_1(x) &amp;= \frac{x-x_0}{x_1-x_0} = \frac{1}{h}(x-a).
\end{split}
\tag{7.9}\]</span></span> The constants <span class="math inline">\(c_0,c_1\)</span> are then <span id="eq-int:coeff-1"><span class="math display">\[
\begin{split}
c_0 &amp;= \int_a^b L_0(x) dx = -\frac{1}{h}\int_a^b (x-b) dx \\
&amp;= -\frac{1}{2h}\left[(x-b)^2\right]_{x=a}^b = \frac{h}{2},\\
c_1 &amp;= \int_a^b L_1(x) dx = \frac{1}{h}\int_a^b (x-a) dx \\
&amp;= \frac{1}{2h}\left[(x-a)^2\right]_{x=a}^b = \frac{h}{2}.
\end{split}
\tag{7.10}\]</span></span> The approximation formula <a href="#eq-int:def" class="quarto-xref">Eq.&nbsp;<span>7.6</span></a> then gives <span id="eq-int:trapezium-1"><span class="math display">\[
\int_a^bf(x)dx \approx \frac{h}{2}(f(a)+f(b)),
\tag{7.11}\]</span></span> which is exactly the Trapezium rule.</p>
<div class="proof remark">
<p><span class="proof-title"><em>Remark</em>. </span>It can be shown by direct calculation that the Trapezium rule produces an exact result for <span class="math inline">\(f(x)=1\)</span>, <span class="math inline">\(f(x)=x\)</span> and, hence for any polynomial of degree <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>. (Prove it!)</p>
</div>
<p>Let us now consider the error term <span class="math inline">\(E(f)\)</span>. We assume that <span class="math inline">\(f\in C^{2}[a,b]\)</span> and employ the formula for the error of the interpolation polynomial <span id="eq-d19"><span class="math display">\[
f(x)=P(x)+\frac{f^{\prime\prime}(\xi(x))}{2!}(x-x_{0})(x-x_{1}).
\tag{7.12}\]</span></span> Since <span class="math inline">\(f\in C^{2}[a,b]\)</span>, we have <span id="eq-d19a"><span class="math display">\[
m\leq f^{\prime\prime}(x)\leq M \quad \text{  for \ all } \ \ x\in[a,b],
\tag{7.13}\]</span></span> where <span id="eq-d19b"><span class="math display">\[
m=\min_{x\in[a,b]} f^{\prime\prime}(x), \quad M=\max_{x\in[a,b]} f^{\prime\prime}(x) .
\tag{7.14}\]</span></span> Let <span id="eq-d19c"><span class="math display">\[
B(x)=-\frac{(x-x_{0})(x-x_{1})}{2}.
\tag{7.15}\]</span></span> Evidently, <span class="math inline">\(B(x)\geq 0\)</span> for all <span class="math inline">\(x\in[a,b]\)</span>. Therefore, it follows from <a href="#eq-d19" class="quarto-xref">Eq.&nbsp;<span>7.12</span></a> that <span id="eq-d19d"><span class="math display">\[
m \, B(x) \leq P(x)-f(x) \leq M \, B(x).
\tag{7.16}\]</span></span> Integration of these inequalities yields <span id="eq-d20"><span class="math display">\[
m \, \int_{x_{0}}^{x_{1}} B(x)dx \leq \int_{x_{0}}^{x_{1}}\left(P(x)-f(x)\right)dx \leq M \, \int_{x_{0}}^{x_{1}}B(x)dx.
\tag{7.17}\]</span></span> Since <span id="eq-d20a"><span class="math display">\[
\begin{split}
\int_{x_{0}}^{x_{1}} B(x)dx &amp;=\frac{1}{2}\int_{x_{0}}^{x_{1}}(x-x_{0})(x_{1}-x)dx \\
&amp;=\frac{1}{2}\int_{0}^{1}h \, t \, h (1-t) \, h \, dt\\
&amp;=\frac{h^3}{2}\left(\frac{t^2}{2}-\frac{t^3}{3}\right)\Biggm\vert_{t=0}^{t=1}=\frac{h^3}{12}.
\end{split}
\tag{7.18}\]</span></span> (here we have introduced new variable of integration <span class="math inline">\(t\)</span> by the formula <span class="math inline">\(x=x_{0}+t h\)</span>) <a href="#eq-d20" class="quarto-xref">Eq.&nbsp;<span>7.17</span></a> can we rewritten as <span id="eq-d21"><span class="math display">\[
m  \leq \frac{12}{h^3}\int_{x_{0}}^{x_{1}}\left(P(x)-f(x)\right)dx \leq M .
\tag{7.19}\]</span></span> Since <span class="math inline">\(f^{\prime\prime}(x)\)</span> is continuous in <span class="math inline">\([a,b]\)</span>, the intermediate value theorem says that there exists <span class="math inline">\(\xi\in[a,b]\)</span> such that <span id="eq-d21a"><span class="math display">\[
f^{\prime\prime}(\xi)=\frac{12}{h^3}\int_{x_{0}}^{x_{1}}\left(P(x)-f(x)\right)dx.
\tag{7.20}\]</span></span> This and the expression for the integral of <span class="math inline">\(P(x)\)</span> give us the <em>Trapezium rule</em> with error term: <span id="eq-d22"><span class="math display">\[
\int_{x_{0}}^{x_{1}}f(x)dx = \frac{h}{2}\left(f(x_{0})+f(x_{1})\right)-\frac{h^3}{12}f^{\prime\prime}(\xi).  
\tag{7.21}\]</span></span> We see that the error term can be controlled by an estimate of the second derivative of <span class="math inline">\(f\)</span>. Also, it will be small if <span class="math inline">\(h\)</span> is small. Evidently, for a fixed interval <span class="math inline">\([a,b]\)</span> we cannot vary <span class="math inline">\(h\)</span> to reduce the error; we will return to this problem later.</p>
</section>
<section id="simpsons-rule" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="simpsons-rule"><span class="header-section-number">7.2</span> Simpson’s rule</h2>
<p>Now let us consider the case <span class="math inline">\(n=2\)</span>, which should yield a better approximation. We have <span class="math inline">\(h=\tfrac{1}{2}(b-a)\)</span>, and our nodes are <span class="math inline">\(x_0=a\)</span>, <span class="math inline">\(x_1=a+h\)</span>, <span class="math inline">\(x_2=a+2h=b\)</span>. We first recall the polynomials&nbsp;<span class="math inline">\(L_j\)</span>: <span id="eq-int:lagrange-2"><span class="math display">\[
\begin{split}
   L_0(x) &amp;= \frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)}=\frac{1}{2h^2}(x-(a+h))(x-b), \\
   L_1(x) &amp;= \frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)}=-\frac{1}{h^2}(x-a)(x-b), \\
   L_2(x) &amp;= \frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)}=\frac{1}{2h^2}(x-a)(x-(a+h)).
\end{split}
\tag{7.22}\]</span></span> Their integrals are, with the same substitution <span class="math inline">\(x=a+ht\)</span> as before (but now <span class="math inline">\(0 \leq t \leq 2\)</span>), <span id="eq-int:coeff-2"><span class="math display">\[
\begin{split}
c_0=\int_a^b L_0(x)\,dx
&amp;=  \frac{h}{2} \int_0^2 (t-1)(t-2) dt = \frac{h}{2}\frac{2}{3} = \frac{h}{3},
\\
c_1=\int_a^b L_1(x)\,dx
&amp;=  -h \int_0^2 t(t-2) dt = -h\left( -\frac{4}{3}\right) = \frac{4h}{3},
\\
c_2=\int_a^b L_2(x)\,dx
&amp;=  \frac{h}{2} \int_0^2 t(t-1) dt = \frac{h}{2}\frac{2}{3} = \frac{h}{3}.
\end{split}
\tag{7.23}\]</span></span> This means that our approximation formula is <span id="eq-int:simpson"><span class="math display">\[
\int_a^bf(x)dx \approx \frac{h}{3}\left( f(a)+4 f(a+h)+f(b)\right).
\tag{7.24}\]</span></span> This is known as <em>Simpson’s rule</em>, which is graphically represented in <a href="#fig-Simpson" class="quarto-xref">Figure&nbsp;<span>7.2</span></a>.</p>
<div id="fig-Simpson" class="quarto-float quarto-figure quarto-figure-left anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-Simpson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="figures/chapter07/simpson.png" class="img-fluid figure-img" style="width:80.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-Simpson-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: Simpson’s rule
</figcaption>
</figure>
</div>
<p><strong>Error term for Simpson’s rule.</strong> Let us recall the Trapezium rule with error term: <span id="eq-e1"><span class="math display">\[
\int_{x_{0}}^{x_{1}}f(x)dx = \frac{h}{2}\left[f(x_{0})+f(x_{1})\right]-
\frac{h^3}{12}f^{\prime\prime}(\xi).  
\tag{7.25}\]</span></span> It has been obtained by integrating the linear interpolating polynomial with nodes <span class="math inline">\(x_{0}\)</span> and <span class="math inline">\(x_{1}=x_{0}+h\)</span>. Therefore, it must produce an exact result for any polynomial of degree 0 and 1. Indeed, the error term in <a href="bvp.html#eq-e1" class="quarto-xref">Eq.&nbsp;<span>11.59</span></a> vanishes for polynomials of degree 0 and 1.</p>
<p>Simpson’s rule has been obtained by integrating the quadratic interpolating polynomial with nodes <span class="math inline">\(x_{0}\)</span>, <span class="math inline">\(x_{1}=x_{0}+h\)</span> and <span class="math inline">\(x_{2}=x_{0}+2h\)</span>. So, it must produce an exact result for polynomials of degree 0, 1 and 2. Will it generate a nonzero error for cubic polynomials? To examine this, it suffices to consider <span class="math inline">\(f(x)=x^3\)</span>. By analogy with the Trapezium rule we assume that Simpson’s rule with error term has the form <span id="eq-e2"><span class="math display">\[
\int_{x_{0}}^{x_{2}}f(x)dx = \frac{h}{3}\left[f(x_{0})+4f(x_{1})  + f(x_{2})\right]
+Cf'''(\xi)  
\tag{7.26}\]</span></span> for some constant <span class="math inline">\(C\)</span> and some <span class="math inline">\(\xi\in[x_{0},x_{2}]\)</span>. Substituting <span class="math inline">\(f(x)=x^3\)</span> in <a href="#eq-e2" class="quarto-xref">Eq.&nbsp;<span>7.26</span></a>, we obtain <span id="eq-e3"><span class="math display">\[
\int_{x_{0}}^{x_{2}}x^3 dx = \frac{h}{3}\left[x_{0}^3+4x_{1}^3  + x_{2}^3\right]
+6C.  
\tag{7.27}\]</span></span> The integral on the left hand side of <a href="bvp.html#eq-e3" class="quarto-xref">Eq.&nbsp;<span>11.69</span></a> can be written as <span id="eq-e4"><span class="math display">\[\begin{split}
(\text{  l.h.s. }) \, &amp;= \, \frac{x_{2}^{4}}{4}-\frac{x_{0}^{4}}{4}
=\frac{(x_{0}+2h)^{4}}{4}-\frac{x_{0}^{4}}{4}\\
&amp;=2h x_{0}^{3}+6h^2 x_{0}^{2}+8h^3 x_{0}+4h^4.
\end{split}
\tag{7.28}\]</span></span> For the right hand side of <a href="bvp.html#eq-e3" class="quarto-xref">Eq.&nbsp;<span>11.69</span></a>, we have <span id="eq-e5"><span class="math display">\[
\begin{split}
(\text{  r.h.s. }) &amp;=\frac{h}{3}\left[x_{0}^3+4(x_{0}+h)^3  + (x_{0}+2h)^3\right]+6C \\
&amp;=\frac{h}{3}\Bigl[x_{0}^3+4\left(x_{0}^{3}+3x_{0}^{2}h+3x_{0}h^{2}+h^{3}\right)\\
&amp;\qquad\qquad +
x_{0}^{3}+6x_{0}^{2}h+12x_{0}h^{2}+8h^{3}\Bigr]+6C\\
&amp;=\frac{h}{3}\left[6x_{0}^3+18x_{0}^{2}h+24x_{0}h^{2}+12h^{3}\right]+6C\\
&amp;=2h x_{0}^{3}+6h^2 x_{0}^{2}+8h^3 x_{0}+4h^4+6C.
\end{split}
\tag{7.29}\]</span></span> If follows from <a href="#eq-e4" class="quarto-xref">Eq.&nbsp;<span>7.28</span></a> and <a href="#eq-e5" class="quarto-xref">Eq.&nbsp;<span>7.29</span></a> that <a href="bvp.html#eq-e3" class="quarto-xref">Eq.&nbsp;<span>11.69</span></a> simplifies to <span class="math inline">\(0=6C\)</span>, so that <span class="math inline">\(C=0\)</span>. This means that Simpson’s rule is exact for polynomials of degree 3 (an unexpected result!).</p>
<p>This also means that our assumption about the error term for Simpson’s rule is wrong. So, we make another assumption, namely: <span id="eq-e6"><span class="math display">\[
\int_{x_{0}}^{x_{2}}f(x)dx = \frac{h}{3}\left[f(x_{0})+4f(x_{1})  + f(x_{2})\right]
+Cf^{(4)}(\xi).  
\tag{7.30}\]</span></span> To find <span class="math inline">\(C\)</span>, we substitute <span class="math inline">\(f(x)=x^4\)</span> in <a href="#eq-e6" class="quarto-xref">Eq.&nbsp;<span>7.30</span></a>. This yields the equation <span id="eq-e7"><span class="math display">\[
\int_{x_{0}}^{x_{2}}x^4 dx = \frac{h}{3}\left[x_{0}^4+4x_{1}^4  + x_{2}^4\right]
+24C.  
\tag{7.31}\]</span></span> The left hand side of <a href="#eq-e7" class="quarto-xref">Eq.&nbsp;<span>7.31</span></a> can be written as <span id="eq-e8"><span class="math display">\[\begin{split}
(\text{  l.h.s. }) \, &amp;= \, \frac{x_{2}^{5}}{5}-\frac{x_{0}^{5}}{5}  =\frac{(x_{0}+2h)^{5}}{5}-\frac{x_{0}^{4}}{4}\\
&amp;=2h x_{0}^{4}+8h^2 x_{0}^{3}+16h^3 x_{0}^{2}+16h^4 x_{0}+\frac{32}{5}h^5.
\end{split}
\tag{7.32}\]</span></span> For the right hand side of <a href="#eq-e7" class="quarto-xref">Eq.&nbsp;<span>7.31</span></a>, we have <span id="eq-e9"><span class="math display">\[
\begin{split}
(\text{  r.h.s. }) &amp;=\frac{h}{3}\left[x_{0}^4+4(x_{0}+h)^4  + (x_{0}+2h)^4\right]+24C\\
&amp;=\frac{h}{3}\Bigl[x_{0}^3+4\left(x_{0}^{4}+4x_{0}^{3}h+6x_{0}^{2}h^2 + 4x_{0}h^3 +h^{4}\right)\\
&amp; \qquad\qquad +
x_{0}^{4}+8x_{0}^{3}h+24x_{0}^{2}h^2+
32x_{0}h^{3}+16h^{4}\Bigr]+24C\\
&amp;=\frac{h}{3}\left[6x_{0}^4+24x_{0}^{3}h+48x_{0}^{2}h^{2}+48x_{0}h^{3}+20h^{4}\right]+24C\\
&amp;=2h x_{0}^{4}+8h^2 x_{0}^{3}+16 h^3 x_{0}^{2}+16 h^4 x_{0}+\frac{20}{3}h^5+24C.
\end{split}
\tag{7.33}\]</span></span> <a href="#eq-e7" class="quarto-xref">Eq.&nbsp;<span>7.31</span></a>–<a href="#eq-e9" class="quarto-xref">Eq.&nbsp;<span>7.33</span></a> imply that <span id="eq-e9a"><span class="math display">\[
\frac{32}{5}h^5=\frac{20}{3}h^5+24C.
\tag{7.34}\]</span></span> so that <span id="eq-e9b"><span class="math display">\[
C=-\frac{h^5}{90}.
\tag{7.35}\]</span></span> Thus, Simpson’s rule with error term is given by <span id="eq-e10"><span class="math display">\[
\int_{x_{0}}^{x_{2}}f(x)dx = \frac{h}{3}\left[f(x_{0})+4f(x_{1})  + f(x_{2})\right]
-\frac{h^{5}}{90}f^{(4)}(\xi)  
\tag{7.36}\]</span></span> for some <span class="math inline">\(\xi\in[x_{0},x_{2}]\)</span>. Note that the above argument is not a proof of the existence of such <span class="math inline">\(\xi\)</span>. Alternative derivations of formula <a href="#eq-e10" class="quarto-xref">Eq.&nbsp;<span>7.36</span></a> can be found in textbooks on Numerical Analysis (e.g. <span class="citation" data-cites="Burden_Faires">(<a href="references.html#ref-Burden_Faires" role="doc-biblioref">Burden and Faires 2010</a>)</span>).</p>
</section>
<section id="higher-order-newton-cotes-formulae" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="higher-order-newton-cotes-formulae"><span class="header-section-number">7.3</span> Higher-order Newton-Cotes formulae</h2>
<p>We have now seen that the Trapezium and Simpson’s rules are examples of <em>Newton-Cotes formulae</em>, which are obtained by integrating of an interpolating polynomial for interpolation points <span class="math inline">\(x_{0}, \dots, x_{n}\)</span>. The Trapezium rule and Simpson’s rule correspond to <span class="math inline">\(n=1\)</span> and <span class="math inline">\(n=2\)</span> respectively. For <span class="math inline">\(n=3\)</span>, we have <strong>Simpson’s three-eighth rule</strong> <span id="eq-e11"><span class="math display">\[
\int_{x_{0}}^{x_{3}}f(x)dx= {3h \over 8}
\left[f(x_{0})+3f(x_{1})+3f(x_{2})+f(x_{3})\right]-
{3h^{5} \over 80}f^{(4)}(\xi),
\tag{7.37}\]</span></span> where <span class="math inline">\(h=(x_{3}-x_{0})/3\)</span> and <span class="math inline">\(\xi\in[x_{0},x_{3}]\)</span>. The error of Simpson’s three-eighth rule is proportional to <span class="math inline">\(h^5\)</span> with a coefficient that is larger than that in the error term of Simpson’s rule, so this method seems less efficient than Simpson’s rule.</p>
<p>For <span class="math inline">\(n=4\)</span> we have the formula <span id="eq-e12"><span class="math display">\[
\begin{split}
\int_{x_{0}}^{x_{4}}f(x)dx=&amp; {2h \over 45}
\left[7f(x_{0})+32f(x_{1})+12f(x_{2})+32f(x_{3})
+7f(x_{4})\right]\\
&amp;-{8h^{7} \over 945}f^{(6)}(\xi).
\end{split}
\tag{7.38}\]</span></span> where <span class="math inline">\(h=(x_{4}-x_{0})/4\)</span> and <span class="math inline">\(\xi\in[x_{0},x_{4}]\)</span>.</p>
</section>
<section id="composite-numerical-integration" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="composite-numerical-integration"><span class="header-section-number">7.4</span> Composite numerical integration</h2>
<p>The Newton-Cotes formulas are generally unsuitable for large integration intervals. This would require high-degree formulas. An alternative to this is a <em>piecewise</em> approach to numerical integration that uses the low-order Newton-Cotes formulas such as the Trapezium and Simpson’s rules.</p>
<p>Let us apply Simpson’s formula to approximate the integral <span class="math inline">\(\int_{0}^{4}x^{4}dx\)</span>. We have <span id="eq-e13a"><span class="math display">\[
\begin{split}
I &amp;= \int_{0}^{4}x^{4}dx\approx \frac{2}{3}
\left[0 + 4\cdot 2^{4}+4^{4}\right]=\frac{2}{3}(64+256)=213.333, \\
E&amp;=\vert I-213.333\vert=\vert 204.8-213.333\vert=8.533.
\end{split}
\tag{7.39}\]</span></span> To apply a piecewise technique to this problem, we divide <span class="math inline">\([0, 4]\)</span> into two subintervals <span class="math inline">\([0, 2]\)</span> and <span class="math inline">\([2, 4]\)</span> and use Simpson’s rule twice with <span class="math inline">\(h=1\)</span>: <span id="eq-e13b"><span class="math display">\[
\begin{split}
I =&amp; \int_{0}^{4}x^{4}dx\approx \frac{1}{3}
\left[0 + 4\cdot 1^{4}+2^{4}\right] \\
&amp;+ \frac{1}{3}\left[2^{4} + 4\cdot 3^{4}+4^{4}\right]=205.333, \\
E=&amp;\vert 204.8-205.333\vert=0.533.
\end{split}
\tag{7.40}\]</span></span> To reduce the error, we can proceed further by subdividing the intervals <span class="math inline">\([0, 2]\)</span> and <span class="math inline">\([2, 4]\)</span> and use Simpson’s rule with <span class="math inline">\(h=1/2\)</span>.</p>
<p>To generalize this procedure, we choose an <em>even</em> integer <span class="math inline">\(n\)</span> and divide the interval <span class="math inline">\([a, b]\)</span> into <span class="math inline">\(n\)</span> subintervals. Then we apply Simpson’s rule to each consecutive pair of subintervals. With <span class="math inline">\(h=(b-a)/n\)</span> and <span class="math inline">\(x_{j}=a+jh\)</span> for <span class="math inline">\(j=0, 1, ..., n\)</span>, we have <span id="eq-e13c"><span class="math display">\[
\begin{split}
\int_{a}^{b}f(x)dx &amp;=\sum_{j=1}^{n/2}
\int_{x_{2j-2}}^{x_{2j}}f(x)dx \\
&amp;=
\sum_{j=1}^{n/2}\left\{
\frac{h}{3}\left[f(x_{2j-2})+4f(x_{2j-1})+f(x_{2j})\right]-
\frac{h^{5}}{90}f^{(4)}(\xi_{j})\right\}
\end{split}
\tag{7.41}\]</span></span> for some <span class="math inline">\(\xi_{j}\)</span> between <span class="math inline">\(x_{2j-2}\)</span> and <span class="math inline">\(x_{2j}\)</span>, provided that <span class="math inline">\(f\in C^{4}[a, b]\)</span>.</p>
<p>One can see that for each <span class="math inline">\(j=1, 2, ..., (n/2)-1\)</span>, the number <span class="math inline">\(f(x_{2j})\)</span> appears in the term corresponding to the interval <span class="math inline">\([x_{2j-2}, x_{2j}]\)</span> and also in the term corresponding to the interval <span class="math inline">\([x_{2j}, x_{2j+2}]\)</span>. Taking this into account, we obtain <span id="eq-e13d"><span class="math display">\[
\begin{split}
\int_{a}^{b}f(x)dx &amp;= \sum_{j=1}^{n/2}
\int_{x_{2j-2}}^{x_{2j}}f(x)dx  \\
&amp;=
\frac{h}{3}\left\{ f(x_{0})+2\sum_{j=1}^{(n/2)-1}f(x_{2j})+
4\sum_{j=1}^{n/2}f(x_{2j-1})+ f(x_{n})\right\}
+E.  
\end{split}
\tag{7.42}\]</span></span> The error of this approximation is <span id="eq-composite-error"><span class="math display">\[
E=-{h^{5} \over 90}\sum_{j=1}^{n/2}f^{(4)}(\xi_{j})
\tag{7.43}\]</span></span> where <span class="math inline">\(x_{2j-2} &lt; \xi_{j} &lt; x_{2j}\)</span> for each <span class="math inline">\(j=1, 2, ..., n/2\)</span>. If <span class="math inline">\(f\in C^{4}[a, b]\)</span>, then (according to the Extreme Value Theorem) <span class="math inline">\(f^{(4)}(x)\)</span> attains its maximum and minimum values in <span class="math inline">\([a, b]\)</span>. Let <span id="eq-composite-bounds"><span class="math display">\[
m=\min_{x\in[a, b]}f^{(4)}(x), \quad M=\max_{x\in[a, b]}f^{(4)}(x).
\tag{7.44}\]</span></span> Then we have <span id="eq-composite-inequality1"><span class="math display">\[
m \leq f^{(4)}(\xi_{j}) \leq M \ \ \
\text{  for \ each } \ \ j=1, 2, ..., n/2 .
\tag{7.45}\]</span></span> Therefore, <span id="eq-composite-inequality2"><span class="math display">\[
\frac{n}{2}m \leq
\sum_{j=1}^{n/2}f^{(4)}(\xi_{j}) \leq \frac{n}{2} M,
\tag{7.46}\]</span></span> and <span id="eq-composite-inequality3"><span class="math display">\[
m \leq \frac{2}{n}
\sum_{j=1}^{n/2}f^{(4)}(\xi_{j}) \leq M.
\tag{7.47}\]</span></span> By the Intermediate Value Theorem, there is a <span class="math inline">\(\mu\in(a, b)\)</span> such that <span id="eq-composite-mu"><span class="math display">\[
f^{(4)}(\mu)={2 \over n}
\sum_{j=1}^{n/2}f^{(4)}(\xi_{j}).
\tag{7.48}\]</span></span> Hence, <span id="eq-composite-final-error"><span class="math display">\[
E=-{h^{5}\over 180}n f^{(4)}(\mu)=-{b-a \over 180}h^{4} f^{(4)}(\mu).
\tag{7.49}\]</span></span> Thus, we have proved the following theorem.</p>
<div id="thm-11" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.1 (Composite Simpson’s rule)</strong></span> Let <span class="math inline">\(f\in C^{4}[a, b]\)</span>, <span class="math inline">\(n\)</span> be even, <span class="math inline">\(h=(b-a)/n\)</span>, and <span class="math inline">\(x_{j}=a+jh\)</span> for <span class="math inline">\(j=0, 1, ..., n\)</span>. There exist a number <span class="math inline">\(\mu\in(a, b)\)</span> such that <span id="eq-e13"><span class="math display">\[
\begin{split}
\int_{a}^{b}f(x)dx =&amp;
{h\over 3}\left\{ f(x_{0})+2\sum_{j=1}^{(n/2)-1}f(x_{2j})+
4\sum_{j=1}^{n/2}f(x_{2j-1})+ f(x_{n})\right\} \\
&amp;-\frac{b-a}{180}h^{4}f^{(4)}(\mu).
\end{split}
\tag{7.50}\]</span></span></p>
</div>
<p>Similarly, one can prove analogous theorems for Composite Trapezium rule.</p>
<div id="thm-12" class="theorem">
<p><span class="theorem-title"><strong>Theorem 7.2 (Composite Trapezium rule)</strong></span> Let <span class="math inline">\(f\in C^{2}[a, b]\)</span>, <span class="math inline">\(h=(b-a)/n\)</span>, and <span class="math inline">\(x_{j}=a+jh\)</span> for <span class="math inline">\(j=0, 1, ..., n\)</span>. There exist a number <span class="math inline">\(\mu\in(a, b)\)</span> such that <span id="eq-e14"><span class="math display">\[
\int_{a}^{b}f(x)dx=
\frac{h}{2}\left\{ f(x_{0})+2\sum_{j=1}^{n-1}f(x_{j})+ f(x_{n})\right\}
-\frac{b-a}{12}h^{2}f^{\prime\prime}(\mu).
\tag{7.51}\]</span></span></p>
</div>
<div id="exm-16" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.1</strong></span> Apply the composite Simpson rule to compute <span id="eq-example-integral"><span class="math display">\[
I=\int\limits_{0}^{2}e^{x}dx
\tag{7.52}\]</span></span> with absolute error less than <span class="math inline">\(10^{-2}\)</span>.</p>
</div>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>First we need to determine the number of subintervals* <span class="math inline">\(n\)</span> in the composite Simpson rule that would ensure that absolute error less than <span class="math inline">\(10^{-2}\)</span>. It follows from <a href="#eq-e13" class="quarto-xref">Eq.&nbsp;<span>7.50</span></a> that <span id="eq-e15"><span class="math display">\[
E=\frac{b-a}{180}h^{4}\vert f^{(4)}(\mu)\vert\leq \frac{b-a}{180}h^{4}M,
\tag{7.53}\]</span></span> where <span class="math inline">\(M\)</span> is the upper bound for <span class="math inline">\(\vert f^{(4)}(x)\vert\)</span> in <span class="math inline">\([0,2]\)</span>. Evidently, <span class="math inline">\(M=e^2\)</span>. Therefore, we require that <span id="eq-example-inequality"><span class="math display">\[
\frac{b-a}{180}h^{4}e^2 &lt; 10^{-2} \quad \Leftrightarrow \quad
\frac{(b-a)^5}{180 n^4}e^2 &lt; 10^{-2}  \quad \Leftrightarrow \quad
n^4 &gt; \frac{100(b-a)^5}{180}e^2 .
\tag{7.54}\]</span></span> Substituting <span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=2\)</span>, we find that <span id="eq-example-n"><span class="math display">\[
n^4 &gt; \frac{5\cdot 32 e^2}{9}=131.3609973, \quad \text{  so \ that } \ \ n\geq 4 \ \ (n^4=256).
\tag{7.55}\]</span></span> Applying the composite Simpson rule with <span class="math inline">\(n=4\)</span>, we obtain the approximation <span id="eq-example-approx"><span class="math display">\[
\tilde{I}=6.391210187.
\tag{7.56}\]</span></span> The actual error is <span id="eq-example-error"><span class="math display">\[
\vert I-\tilde{I}\vert=0.002154088.
\tag{7.57}\]</span></span> So it is indeed less that <span class="math inline">\(10^{-2}\)</span>.</p>
</div>
<p>All the Composite Newton-Cotes techniques are stable with respect to roundoff error. Consider, for example, the Composite Simpson rule with <span class="math inline">\(n\)</span> subintervals applied to a function <span class="math inline">\(f(x)\)</span> on <span class="math inline">\([a, b]\)</span>. We assume that <span class="math inline">\(f(x_{i})\)</span> is approximated by <span class="math inline">\(\tilde f(x_{i})\)</span> with the roundoff error <span class="math inline">\(e_{i}\)</span>. Then, the accumulated error in the Composite Simpson rule is <span id="eq-roundoff-bound1"><span class="math display">\[
\begin{split}
E(h) &amp;= \left\vert\frac{h}{3}\left( e_{0}
+2\sum_{j=1}^{(n/2)-1}e_{2j}+
4\sum_{j=1}^{n/2}e_{2j-1}+ e_{n}\right)\right\vert \\
&amp;\leq
\frac{h}{3}\left( \vert e_{0}\vert
+2\sum_{j=1}^{(n/2)-1}\vert e_{2j}\vert +
4\sum_{j=1}^{n/2}\vert e_{2j-1}\vert + \vert e_{n}\vert\right)
\end{split}
\tag{7.58}\]</span></span> If the roundoff errors are uniformly bounded by <span class="math inline">\(\varepsilon\)</span>, then <span id="eq-roundoff-bound2"><span class="math display">\[
E(h) \leq
{h \over 3}\left(\varepsilon
+2\left(\frac{n}{2}-1\right)\varepsilon +
4\frac{n}{2}\varepsilon + \varepsilon\right)=nh\varepsilon=(b-a)\varepsilon.
\tag{7.59}\]</span></span> Thus, the bound for the accumulated error is independent of <span class="math inline">\(h\)</span>, so that <span class="math inline">\(h\)</span> can be taken as small as we wish.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Burden_Faires" class="csl-entry" role="listitem">
Burden, Richard L., and J. Douglas Faires. 2010. <em>Numerical <span>Analysis</span></em>. 9th ed. Brooks Cole.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter06.html" class="pagination-link" aria-label="Approximation and interpolation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Approximation and interpolation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter08.html" class="pagination-link" aria-label="Numerical differentiation">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Numerical differentiation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
    <footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/gustavdelius/NumericalAnalysis2018-23/edit/main/chapter07.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer><script type="text/javascript">
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        let pseudocodeOptions = {
          indentSize: el.dataset.indentSize || "1.2em",
          commentDelimiter: el.dataset.commentDelimiter || "//",
          lineNumber: el.dataset.lineNumber === "true" ? true : false,
          lineNumberPunc: el.dataset.lineNumberPunc || ":",
          noEnd: el.dataset.noEnd === "true" ? true : false,
          titlePrefix: el.dataset.captionPrefix || "Algorithm"
        };
        pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
      });
    })(document);
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        let captionSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
        if (captionSpan !== null) {
          let captionPrefix = el.dataset.captionPrefix + " ";
          let captionNumber = "";
          if (el.dataset.pseudocodeNumber) {
            captionNumber = el.dataset.pseudocodeNumber + " ";
            if (el.dataset.chapterLevel) {
              captionNumber = el.dataset.chapterLevel + "." + captionNumber;
            }
          }
          captionSpan.innerHTML = captionPrefix + captionNumber;
        }
      });
    })(document);
    </script>
  




</body></html>